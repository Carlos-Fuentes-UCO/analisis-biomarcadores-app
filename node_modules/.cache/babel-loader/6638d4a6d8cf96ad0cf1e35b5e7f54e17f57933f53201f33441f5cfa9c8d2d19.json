{"ast":null,"code":"import _objectSpread from\"C:/Users/Carlos-PC/Desktop/TRABAJO/Analisis_Python/AMYLOIDOSIS_TEST_DDA_IBiS_PEAKS_IBIS_DDA_1/analisis-biomarcadores/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';// Define regular expressions patterns for pathogenic variants\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const pathogenicPattern=/(-VAR_)|(-[A-Z]\\d+[A-Z])/;// Main application component\nconst App=()=>{// State to manage multiple file input sets\n// Each element in the array represents a \"slot\" for a sample with its files and name\n// Reverting to expect 'peptides' and 'proteins' files\nconst[sampleInputs,setSampleInputs]=useState([{id:1,name:'',files:{peptides:null,proteins:null}}]);const[nextSampleInputId,setNextSampleInputId]=useState(2);// For unique slot IDs\n// State to store the results of already processed samples\nconst[processedSamples,setProcessedSamples]=useState([]);// State for the IDs of samples selected for the comparative table and visualizations\nconst[selectedProcessedSampleIds,setSelectedProcessedSampleIds]=useState([]);// State for the currently selected protein for the comparative bar chart\nconst[selectedProteinForChart,setSelectedProteinForChart]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// State to indicate if export is in progress\nconst[isExporting,setIsExporting]=useState(false);// State for Chart.js library loading\nconst[isChartLibraryLoaded,setIsChartLibraryLoaded]=useState(false);// Ref for the comparative bar chart canvas and Chart.js instance\nconst comparativeChartCanvasRef=useRef(null);const comparativeChartInstance=useRef(null);// Get selected samples for the comparative table and visualizations\nconst samplesForComparison=processedSamples.filter(sample=>selectedProcessedSampleIds.includes(sample.id));// Helper function to extract disease association\nconst extractDiseaseAssociation=description=>{let association='';// Regex to find \"Association:...\" or \"ClinicalSignificance:...\"\nconst associationMatch=description.match(/Association:([^|]+)/);const clinicalSigMatch=description.match(/ClinicalSignificance:([^|]+)/);if(associationMatch&&associationMatch[1]){association=associationMatch[1].trim();}else if(clinicalSigMatch&&clinicalSigMatch[1]){association=clinicalSigMatch[1].trim();}return association||'N/A';// Return N/A if no association is found\n};// Generate data for the comparative table, heatmap, and bar chart\nconst getComparativeTableAndVisualizationData=()=>{if(samplesForComparison.length===0)return{headers:[],tableRows:[],visualizationData:[],uniqueProteinAccessions:[]};const uniqueProteinAccessions=new Set();const proteinDetailsMap=new Map();// To store description, unique peptides, etc.\nlet maxAbundance=0;// To scale heatmap colors\n// Collect all unique pathogenic variants and their details from selected samples\nsamplesForComparison.forEach(sample=>{sample.analysisResults.forEach(result=>{uniqueProteinAccessions.add(result['Protein Accession']);// Take details from the first sample where the protein is found\nif(!proteinDetailsMap.has(result['Protein Accession'])){proteinDetailsMap.set(result['Protein Accession'],{description:result['Description'],totalPeptides:result['# Total Peptides'],uniquePeptidesCount:result['# Unique Peptides'],isUniqueGroup:result['Is Unique Group?'],peptidesList:result['Unique Peptides List'],diseaseAssociation:extractDiseaseAssociation(result['Description'])});}// Update max abundance for heatmap scaling\nif(result['Average Abundance']>maxAbundance){maxAbundance=result['Average Abundance'];}});});// Create the comparative table headers\nconst headers=[\"Protein Accession\",\"Description\",\"Disease Association / Clinical Significance\",\"# Total Peptides\",\"# Unique Peptides\",\"Is Unique Group?\",\"Unique Peptides List\",...samplesForComparison.map(sample=>\"Average Abundance (\".concat(sample.name,\")\"))];const tableRows=Array.from(uniqueProteinAccessions).map(accession=>{const details=proteinDetailsMap.get(accession);const rowData=[accession,details.description,details.diseaseAssociation,details.totalPeptides,details.uniquePeptidesCount,details.isUniqueGroup?'Yes':'No',details.peptidesList];// Add specific abundance for each sample\nsamplesForComparison.forEach(sample=>{const result=sample.analysisResults.find(res=>res['Protein Accession']===accession);rowData.push(result?result['Average Abundance'].toFixed(2):'N/A');});return rowData;});// Data for heatmap and bar chart\nconst visualizationData=Array.from(uniqueProteinAccessions).map(accession=>{const abundancesBySample={};samplesForComparison.forEach(sample=>{const result=sample.analysisResults.find(res=>res['Protein Accession']===accession);abundancesBySample[sample.name]=result?parseFloat(result['Average Abundance'].toFixed(2)):0;});return{proteinAccession:accession,abundancesBySample:abundancesBySample};});return{headers,tableRows,visualizationData,uniqueProteinAccessions:Array.from(uniqueProteinAccessions),maxAbundance};};const{headers:comparativeHeaders,tableRows:comparativeTableRows,visualizationData,uniqueProteinAccessions:allUniqueProteins,maxAbundance}=getComparativeTableAndVisualizationData();// useEffect to dynamically load Chart.js and verify its availability\nuseEffect(()=>{if(window.Chart){setIsChartLibraryLoaded(true);return;}const chartjsUrl='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js';const script=document.createElement('script');script.src=chartjsUrl;script.id='chartjs-script';script.async=true;script.onload=()=>{setIsChartLibraryLoaded(true);};script.onerror=()=>{setError(\"Error loading Chart.js library. The chart will not be available.\");};document.body.appendChild(script);return()=>{const chartScript=document.getElementById('chartjs-script');if(chartScript&&chartScript.parentNode)chartScript.parentNode.removeChild(chartScript);};},[]);// useEffect to render/update the comparative bar chart\nuseEffect(()=>{if(comparativeChartCanvasRef.current&&selectedProteinForChart&&isChartLibraryLoaded&&samplesForComparison.length>0){const proteinData=samplesForComparison.map(sample=>{const result=sample.analysisResults.find(res=>res['Protein Accession']===selectedProteinForChart);return result?parseFloat(result['Average Abundance'].toFixed(2)):0;});const labels=samplesForComparison.map(sample=>sample.name);if(comparativeChartInstance.current){comparativeChartInstance.current.destroy();}const ctx=comparativeChartCanvasRef.current.getContext('2d');comparativeChartInstance.current=new window.Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:\"Average Abundance for \".concat(selectedProteinForChart),data:proteinData,backgroundColor:'rgba(59, 130, 246, 0.7)',borderColor:'rgba(59, 130, 246, 1)',borderWidth:1}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top'},title:{display:true,text:\"Comparative Abundance for \".concat(selectedProteinForChart)}},scales:{x:{title:{display:true,text:'Sample'}},y:{beginAtZero:true,title:{display:true,text:'Average Abundance (Normalized)'}}}}});}else{if(comparativeChartInstance.current){comparativeChartInstance.current.destroy();comparativeChartInstance.current=null;}}return()=>{if(comparativeChartInstance.current){comparativeChartInstance.current.destroy();comparativeChartInstance.current=null;}};},[selectedProteinForChart,samplesForComparison,isChartLibraryLoaded]);// Function to add a new sample input slot\nconst addSampleInputSlot=()=>{// Reverting to expect 'peptides' and 'proteins' files for each new slot\nsetSampleInputs([...sampleInputs,{id:nextSampleInputId,name:'',files:{peptides:null,proteins:null}}]);setNextSampleInputId(nextSampleInputId+1);};// Function to remove a sample input slot\nconst removeSampleInputSlot=id=>{setSampleInputs(sampleInputs.filter(slot=>slot.id!==id));setSelectedProcessedSampleIds(prev=>prev.filter(sampleId=>sampleId!==id));};// Handler for changing the name for a specific slot\nconst handleSampleNameChange=(id,newName)=>{setSampleInputs(sampleInputs.map(slot=>slot.id===id?_objectSpread(_objectSpread({},slot),{},{name:newName}):slot));};// Handler for changing files for a specific slot\nconst handleSampleFileChange=(id,fileType,file)=>{setSampleInputs(sampleInputs.map(slot=>slot.id===id?_objectSpread(_objectSpread({},slot),{},{files:_objectSpread(_objectSpread({},slot.files),{},{[fileType]:file})}):slot// Fixed: Preserve slot properties including 'name'\n));};// Function to read and parse a CSV file manually\nconst parseCSV=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=e=>{const text=e.target.result;const rows=text.split('\\n').filter(row=>row.trim()!=='');if(rows.length===0){resolve([]);return;}const headers=rows[0].split(',').map(header=>header.trim().replace(/\"/g,''));const data=[];for(let i=1;i<rows.length;i++){const values=rows[i].split(',');if(values.length!==headers.length){console.warn(\"Skipping row \".concat(i+1,\" due to column mismatch.\"));continue;}const rowObject={};headers.forEach((header,index)=>{rowObject[header]=values[index].trim().replace(/\"/g,'');});data.push(rowObject);}resolve(data);};reader.onerror=e=>reject(e);reader.readAsText(file);});};// Function to process all configured samples - Reverting to original multi-file processing logic\nconst processAllSamples=async()=>{setLoading(true);setError(null);const newProcessedSamples=[];let hasError=false;for(const sampleInput of sampleInputs){if(!sampleInput.name.trim()){setError(\"Error: Sample in slot \".concat(sampleInput.id,\" does not have a valid name.\"));hasError=true;break;}// Now checking for both peptides and proteins files\nif(!sampleInput.files.peptides||!sampleInput.files.proteins){setError(\"Error: Sample \\\"\".concat(sampleInput.name,\"\\\" does not have both 'Peptides File' and 'Proteins File' loaded.\"));hasError=true;break;}if(newProcessedSamples.some(s=>s.name===sampleInput.name.trim())){setError(\"Error: A sample with the name \\\"\".concat(sampleInput.name,\"\\\" already exists. Sample names must be unique.\"));hasError=true;break;}try{const peptidesData=await parseCSV(sampleInput.files.peptides);const proteinsData=await parseCSV(sampleInput.files.proteins);// --- Original processing logic (Steps 1-6) ---\n// Step 1: Combine data\nconst peptidesMap=new Map();peptidesData.forEach(p=>{if(!peptidesMap.has(p['Protein Accession']))peptidesMap.set(p['Protein Accession'],[]);peptidesMap.get(p['Protein Accession']).push(p);});const proteinsMap=new Map();proteinsData.forEach(p=>proteinsMap.set(p['Accession'],p));const mergedData=peptidesData.map(peptide=>{const proteinInfo=proteinsMap.get(peptide['Protein Accession']);return _objectSpread(_objectSpread({},peptide),{},{Description:proteinInfo?proteinInfo.Description:'',Accession:proteinInfo?proteinInfo.Accession:'','Area IBIS_DDA_1':parseFloat(peptide['Area IBIS_DDA_1'])||0,'-10lgP':parseFloat(peptide['-10lgP'])||0});});// Step 2: Data Normalization\nconst totalArea=mergedData.reduce((sum,item)=>sum+item['Area IBIS_DDA_1'],0);const normFactor=totalArea>0?1000000/totalArea:1;const normalizedData=mergedData.map(item=>_objectSpread(_objectSpread({},item),{},{'Area IBIS_DDA_1':item['Area IBIS_DDA_1']*normFactor}));// Step 3: Determine group uniqueness and unique peptides\nconst proteinGroups=new Map();normalizedData.forEach(d=>{const group=d['Protein Group'];if(!proteinGroups.has(group))proteinGroups.set(group,new Set());proteinGroups.get(group).add(d['Protein Accession']);});const uniquePeptides=new Map();normalizedData.forEach(d=>{if(d['Unique']==='Y'){if(!uniquePeptides.has(d['Protein Accession']))uniquePeptides.set(d['Protein Accession'],new Set());uniquePeptides.get(d['Protein Accession']).add(d.Peptide);}});const processedData=normalizedData.map(d=>_objectSpread(_objectSpread({},d),{},{'Is Protein Group Unique?':proteinGroups.get(d['Protein Group']).size===1,'Unique Peptides List':Array.from(uniquePeptides.get(d['Protein Accession'])||[]).join('; '),'# Unique Peptides':(uniquePeptides.get(d['Protein Accession'])||[]).size}));// Step 4: Select the most reliable protein per group\nconst uniqueProteinsMap=new Map();processedData.forEach(item=>{const group=item['Protein Group'];if(!uniqueProteinsMap.has(group)||item['-10lgP']>uniqueProteinsMap.get(group)['-10lgP']){uniqueProteinsMap.set(group,item);}});const uniqueProteins=Array.from(uniqueProteinsMap.values());// Step 5: Filter by pathogenic variants\nconst pathogenicVariants=uniqueProteins.filter(p=>p['Protein Accession']&&pathogenicPattern.test(p['Protein Accession'])&&p.Description&&p.Description.includes('PATHOGENIC_VARIANT'));// Step 6: Calculate average abundance and prepare results\nconst finalResults=pathogenicVariants.map(variant=>{const peptidesForVariant=processedData.filter(p=>p['Protein Accession']===variant['Protein Accession']);const totalPeptides=peptidesForVariant.length;const avgArea=totalPeptides>0?peptidesForVariant.reduce((sum,p)=>sum+p['Area IBIS_DDA_1'],0)/totalPeptides:0;const proteinsInGroup=proteinGroups.get(variant['Protein Group']).size;return{'Protein Accession':variant['Protein Accession'],'Description':variant.Description,'Average Abundance':avgArea,'# Total Peptides':totalPeptides,'# Unique Peptides':variant['# Unique Peptides'],'# Proteins in Group':proteinsInGroup,'Is Unique Group?':variant['Is Protein Group Unique?'],'Unique Peptides List':variant['Unique Peptides List']};}).sort((a,b)=>b['Average Abundance']-a['Average Abundance']);newProcessedSamples.push({id:sampleInput.id,name:sampleInput.name.trim(),analysisResults:finalResults,totalPeptidesCount:peptidesData.length,totalProteinsCount:uniqueProteins.length,normalizationFactor:normFactor});}catch(err){console.error(\"Error processing sample \".concat(sampleInput.name,\":\"),err);setError(\"An error occurred while processing sample \\\"\".concat(sampleInput.name,\"\\\". Please ensure both 'Peptides File' and 'Proteins File' are valid CSVs and contain expected columns. Specific error: \").concat(err.message));hasError=true;break;}}if(!hasError){setProcessedSamples(newProcessedSamples);// Select all processed samples by default for initial comparison\nsetSelectedProcessedSampleIds(newProcessedSamples.map(s=>s.id));if(newProcessedSamples.length>0){setError(null);// Clear any previous error if processing was successful\n}else{setError(\"No samples could be processed. Ensure all files are loaded and names are correct.\");}}setLoading(false);};// Handler for selecting/deselecting samples for comparison\nconst handleSelectSampleForComparison=id=>{setSelectedProcessedSampleIds(prevSelected=>prevSelected.includes(id)?prevSelected.filter(sampleId=>sampleId!==id):[...prevSelected,id]);};// Function to get color for heatmap cell based on abundance\nconst getHeatmapColor=abundance=>{if(abundance===0)return'rgba(240, 240, 240, 1)';// Light gray for N/A or zero\nconst hue=210;// Blue hue\nconst saturation=80;// %\nconst maxLightness=95;// Lightest blue for lowest abundance (non-zero)\nconst minLightness=30;// Darkest blue for highest abundance\nconst scaledAbundance=maxAbundance>0?abundance/maxAbundance:0;const lightness=maxLightness-scaledAbundance*(maxLightness-minLightness);return\"hsl(\".concat(hue,\", \").concat(saturation,\"%, \").concat(lightness,\"%)\");};// Function to export the comparative table to CSV\nconst exportComparativeToCsv=()=>{if(comparativeTableRows.length===0){setError(\"No comparative table data to export.\");return;}setIsExporting(true);const csvRows=[];csvRows.push(comparativeHeaders.join(','));// Add headers\ncomparativeTableRows.forEach(row=>{const formattedRow=row.map(cell=>{// Ensure cells with commas or quotes are properly escaped\nif(typeof cell==='string'&&(cell.includes(',')||cell.includes('\"'))){return\"\\\"\".concat(cell.replace(/\"/g,'\"\"'),\"\\\"\");}return cell;});csvRows.push(formattedRow.join(','));});const csvString=csvRows.join('\\n');const blob=new Blob([csvString],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');if(link.download!==undefined){const url=URL.createObjectURL(blob);link.setAttribute('href',url);link.setAttribute('download','comparative_biomarker_analysis.csv');document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);}else{setError(\"Your browser does not support direct file download.\");}setIsExporting(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 min-h-screen p-4 sm:p-8 font-sans\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto bg-white p-6 rounded-3xl shadow-lg\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl font-extrabold text-blue-700 mb-2\",children:\"Multi-Sample Biomarker Analysis\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600 mb-8\",children:\"Load and compare the abundance of pathogenic proteins across different samples.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 p-6 bg-blue-50 rounded-3xl shadow-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-blue-800 mb-4\",children:\"Manage Samples\"}),sampleInputs.map((sampleSlot,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"sampleName-\".concat(sampleSlot.id),className:\"block text-base font-medium text-gray-700\",children:[\"Sample \",index+1]}),sampleInputs.length>1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeSampleInputSlot(sampleSlot.id),className:\"text-red-600 hover:text-red-800 text-sm font-semibold\",children:\"Remove\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"sampleName-\".concat(sampleSlot.id),value:sampleSlot.name,onChange:e=>handleSampleNameChange(sampleSlot.id,e.target.value),placeholder:\"Sample Name (e.g., Control, Treated)\",className:\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 mb-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 bg-gray-50 rounded-xl border border-gray-100\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Peptides File (`protein-peptides.csv`)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".csv\",onChange:e=>handleSampleFileChange(sampleSlot.id,'peptides',e.target.files[0]),className:\"w-full text-gray-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-100 file:text-blue-700 hover:file:bg-blue-200\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 bg-gray-50 rounded-xl border border-gray-100\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Proteins File (`proteins.csv`)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".csv\",onChange:e=>handleSampleFileChange(sampleSlot.id,'proteins',e.target.files[0]),className:\"w-full text-gray-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-100 file:text-blue-700 hover:file:bg-blue-200\"})]})]})]},sampleSlot.id)),/*#__PURE__*/_jsx(\"button\",{onClick:addSampleInputSlot,className:\"w-full py-2 px-4 bg-gray-200 text-gray-700 font-semibold rounded-2xl hover:bg-gray-300 transition-colors mb-4\",children:\"+ Add Sample Slot\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:processAllSamples,disabled:loading||sampleInputs.some(s=>!s.name.trim()||!s.files.peptides||!s.files.proteins),className:\"w-full py-3 px-6 bg-blue-600 text-white font-bold rounded-2xl shadow-md hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2\",children:[loading&&/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),/*#__PURE__*/_jsx(\"span\",{children:loading?\"Processing Samples...\":\"Process All Samples\"})]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 text-red-700 bg-red-100 rounded-2xl border border-red-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Error:\"}),/*#__PURE__*/_jsx(\"p\",{children:error})]}),processedSamples.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 p-6 bg-gray-50 rounded-3xl shadow-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Select Samples for Comparison\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\",children:processedSamples.map(sample=>/*#__PURE__*/_jsxs(\"label\",{className:\"inline-flex items-center p-2 bg-white rounded-xl border border-gray-200 shadow-sm cursor-pointer hover:bg-gray-100 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedProcessedSampleIds.includes(sample.id),onChange:()=>handleSelectSampleForComparison(sample.id),className:\"form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-gray-700 font-medium\",children:sample.name})]},sample.id))}),selectedProcessedSampleIds.length>0&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-4\",children:[\"Selected samples: \",selectedProcessedSampleIds.length]})]}),visualizationData.length>0&&isChartLibraryLoaded&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 p-6 bg-gray-50 rounded-3xl shadow-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-6\",children:\"Visualizations\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-700 mb-4\",children:\"Comparative Bar Chart (Select a Protein)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"proteinForChart\",className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Select Protein Accession:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"proteinForChart\",value:selectedProteinForChart,onChange:e=>setSelectedProteinForChart(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",disabled:!allUniqueProteins||allUniqueProteins.length===0,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select a Protein --\"}),allUniqueProteins.map(accession=>/*#__PURE__*/_jsx(\"option\",{value:accession,children:accession},accession))]})]}),selectedProteinForChart&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-8 p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\",style:{height:'400px',width:'100%'},children:/*#__PURE__*/_jsx(\"canvas\",{ref:comparativeChartCanvasRef})}),!selectedProteinForChart&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-8 p-4 text-gray-600 bg-gray-100 rounded-2xl border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Select a protein from the dropdown above to view its comparative abundance across samples.\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-700 mb-4 mt-8\",children:\"Comparative Abundance Heatmap\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\",children:visualizationData.length>0&&samplesForComparison.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"inline-block min-w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row sticky top-0 bg-white z-10 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",style:{width:'200px',padding:'8px',fontWeight:'bold'},children:\"Protein Accession\"}),samplesForComparison.map(sample=>/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 text-center\",style:{width:'100px',padding:'8px',fontWeight:'bold'},children:sample.name},sample.id))]}),visualizationData.map((proteinRow,rowIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row border-b border-gray-100 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 overflow-hidden whitespace-nowrap overflow-ellipsis\",style:{width:'200px',padding:'8px',borderRight:'1px solid #e5e7eb'},title:proteinRow.proteinAccession,children:proteinRow.proteinAccession}),samplesForComparison.map(sample=>/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 text-center flex items-center justify-center text-xs font-mono\",style:{width:'100px',padding:'8px',backgroundColor:getHeatmapColor(proteinRow.abundancesBySample[sample.name]),color:proteinRow.abundancesBySample[sample.name]>maxAbundance/2?'white':'black',// Text color for contrast\nborderRight:'1px solid #e5e7eb'},title:\"Abundance: \".concat(proteinRow.abundancesBySample[sample.name].toFixed(2)),children:proteinRow.abundancesBySample[sample.name]>0?proteinRow.abundancesBySample[sample.name].toFixed(0):'N/A'},sample.id))]},rowIndex))]}):/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-gray-600 bg-gray-100 rounded-2xl border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"No data available for heatmap. Process samples and select them for comparison.\"})})})]}),!visualizationData.length>0&&processedSamples.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 p-4 text-gray-700 bg-gray-100 rounded-2xl border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Please select samples for comparison to generate visualizations.\"})}),processedSamples.length>0&&!isChartLibraryLoaded&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 p-4 text-gray-700 bg-gray-100 rounded-2xl border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Loading chart library... Please wait for visualizations to appear.\"})}),comparativeTableRows.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:\"Comparative Abundance Table\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4 text-sm italic\",children:\"Normalized abundances for the selected samples.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:exportComparativeToCsv,disabled:isExporting||comparativeTableRows.length===0,className:\"w-full py-3 px-6 bg-green-600 text-white font-bold rounded-2xl shadow-md hover:bg-green-700 transition-colors disabled:bg-green-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2\",children:/*#__PURE__*/_jsx(\"span\",{children:isExporting?\"Exporting...\":\"Export Comparative Table to Excel (CSV)\"})})}),/*#__PURE__*/_jsx(\"div\",{id:\"comparative-results-table\",className:\"overflow-x-auto rounded-xl shadow-inner border border-gray-200\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsx(\"tr\",{children:comparativeHeaders.map((header,index)=>/*#__PURE__*/_jsx(\"th\",{className:\"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:header},index))})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:comparativeTableRows.map((row,rowIndex)=>/*#__PURE__*/_jsx(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:row.map((cell,cellIndex)=>/*#__PURE__*/_jsx(\"td\",{className:\"px-4 sm:px-6 py-4 whitespace-normal text-sm \".concat(cellIndex<2?'font-medium text-gray-900':'text-gray-700 font-mono'),children:cell},cellIndex))},rowIndex))})]})})]})]})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","pathogenicPattern","App","sampleInputs","setSampleInputs","id","name","files","peptides","proteins","nextSampleInputId","setNextSampleInputId","processedSamples","setProcessedSamples","selectedProcessedSampleIds","setSelectedProcessedSampleIds","selectedProteinForChart","setSelectedProteinForChart","loading","setLoading","error","setError","isExporting","setIsExporting","isChartLibraryLoaded","setIsChartLibraryLoaded","comparativeChartCanvasRef","comparativeChartInstance","samplesForComparison","filter","sample","includes","extractDiseaseAssociation","description","association","associationMatch","match","clinicalSigMatch","trim","getComparativeTableAndVisualizationData","length","headers","tableRows","visualizationData","uniqueProteinAccessions","Set","proteinDetailsMap","Map","maxAbundance","forEach","analysisResults","result","add","has","set","totalPeptides","uniquePeptidesCount","isUniqueGroup","peptidesList","diseaseAssociation","map","concat","Array","from","accession","details","get","rowData","find","res","push","toFixed","abundancesBySample","parseFloat","proteinAccession","comparativeHeaders","comparativeTableRows","allUniqueProteins","window","Chart","chartjsUrl","script","document","createElement","src","async","onload","onerror","body","appendChild","chartScript","getElementById","parentNode","removeChild","current","proteinData","labels","destroy","ctx","getContext","type","data","datasets","label","backgroundColor","borderColor","borderWidth","options","responsive","maintainAspectRatio","plugins","legend","display","position","title","text","scales","x","y","beginAtZero","addSampleInputSlot","removeSampleInputSlot","slot","prev","sampleId","handleSampleNameChange","newName","_objectSpread","handleSampleFileChange","fileType","file","parseCSV","Promise","resolve","reject","reader","FileReader","e","target","rows","split","row","header","replace","i","values","console","warn","rowObject","index","readAsText","processAllSamples","newProcessedSamples","hasError","sampleInput","some","s","peptidesData","proteinsData","peptidesMap","p","proteinsMap","mergedData","peptide","proteinInfo","Description","Accession","totalArea","reduce","sum","item","normFactor","normalizedData","proteinGroups","d","group","uniquePeptides","Peptide","processedData","size","join","uniqueProteinsMap","uniqueProteins","pathogenicVariants","test","finalResults","variant","peptidesForVariant","avgArea","proteinsInGroup","sort","a","b","totalPeptidesCount","totalProteinsCount","normalizationFactor","err","message","handleSelectSampleForComparison","prevSelected","getHeatmapColor","abundance","hue","saturation","maxLightness","minLightness","scaledAbundance","lightness","exportComparativeToCsv","csvRows","formattedRow","cell","csvString","blob","Blob","link","download","undefined","url","URL","createObjectURL","setAttribute","click","revokeObjectURL","className","children","sampleSlot","htmlFor","onClick","value","onChange","placeholder","accept","disabled","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","checked","style","height","width","ref","padding","fontWeight","proteinRow","rowIndex","borderRight","color","cellIndex"],"sources":["C:/Users/Carlos-PC/Desktop/TRABAJO/Analisis_Python/AMYLOIDOSIS_TEST_DDA_IBiS_PEAKS_IBIS_DDA_1/analisis-biomarcadores/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\n\r\n// Define regular expressions patterns for pathogenic variants\r\nconst pathogenicPattern = /(-VAR_)|(-[A-Z]\\d+[A-Z])/;\r\n\r\n// Main application component\r\nconst App = () => {\r\n  // State to manage multiple file input sets\r\n  // Each element in the array represents a \"slot\" for a sample with its files and name\r\n  // Reverting to expect 'peptides' and 'proteins' files\r\n  const [sampleInputs, setSampleInputs] = useState([{ id: 1, name: '', files: { peptides: null, proteins: null } }]);\r\n  const [nextSampleInputId, setNextSampleInputId] = useState(2); // For unique slot IDs\r\n\r\n  // State to store the results of already processed samples\r\n  const [processedSamples, setProcessedSamples] = useState([]);\r\n  // State for the IDs of samples selected for the comparative table and visualizations\r\n  const [selectedProcessedSampleIds, setSelectedProcessedSampleIds] = useState([]);\r\n  // State for the currently selected protein for the comparative bar chart\r\n  const [selectedProteinForChart, setSelectedProteinForChart] = useState('');\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  \r\n  // State to indicate if export is in progress\r\n  const [isExporting, setIsExporting] = useState(false);\r\n\r\n  // State for Chart.js library loading\r\n  const [isChartLibraryLoaded, setIsChartLibraryLoaded] = useState(false);\r\n  // Ref for the comparative bar chart canvas and Chart.js instance\r\n  const comparativeChartCanvasRef = useRef(null);\r\n  const comparativeChartInstance = useRef(null);\r\n\r\n  // Get selected samples for the comparative table and visualizations\r\n  const samplesForComparison = processedSamples.filter(sample =>\r\n    selectedProcessedSampleIds.includes(sample.id)\r\n  );\r\n\r\n  // Helper function to extract disease association\r\n  const extractDiseaseAssociation = (description) => {\r\n    let association = '';\r\n    // Regex to find \"Association:...\" or \"ClinicalSignificance:...\"\r\n    const associationMatch = description.match(/Association:([^|]+)/);\r\n    const clinicalSigMatch = description.match(/ClinicalSignificance:([^|]+)/);\r\n\r\n    if (associationMatch && associationMatch[1]) {\r\n      association = associationMatch[1].trim();\r\n    } else if (clinicalSigMatch && clinicalSigMatch[1]) {\r\n      association = clinicalSigMatch[1].trim();\r\n    }\r\n    return association || 'N/A'; // Return N/A if no association is found\r\n  };\r\n\r\n  // Generate data for the comparative table, heatmap, and bar chart\r\n  const getComparativeTableAndVisualizationData = () => {\r\n    if (samplesForComparison.length === 0) return { headers: [], tableRows: [], visualizationData: [], uniqueProteinAccessions: [] };\r\n\r\n    const uniqueProteinAccessions = new Set();\r\n    const proteinDetailsMap = new Map(); // To store description, unique peptides, etc.\r\n    let maxAbundance = 0; // To scale heatmap colors\r\n\r\n    // Collect all unique pathogenic variants and their details from selected samples\r\n    samplesForComparison.forEach(sample => {\r\n      sample.analysisResults.forEach(result => {\r\n        uniqueProteinAccessions.add(result['Protein Accession']);\r\n        // Take details from the first sample where the protein is found\r\n        if (!proteinDetailsMap.has(result['Protein Accession'])) {\r\n          proteinDetailsMap.set(result['Protein Accession'], {\r\n            description: result['Description'],\r\n            totalPeptides: result['# Total Peptides'],\r\n            uniquePeptidesCount: result['# Unique Peptides'],\r\n            isUniqueGroup: result['Is Unique Group?'],\r\n            peptidesList: result['Unique Peptides List'],\r\n            diseaseAssociation: extractDiseaseAssociation(result['Description'])\r\n          });\r\n        }\r\n        // Update max abundance for heatmap scaling\r\n        if (result['Average Abundance'] > maxAbundance) {\r\n          maxAbundance = result['Average Abundance'];\r\n        }\r\n      });\r\n    });\r\n\r\n    // Create the comparative table headers\r\n    const headers = [\r\n      \"Protein Accession\",\r\n      \"Description\",\r\n      \"Disease Association / Clinical Significance\",\r\n      \"# Total Peptides\",\r\n      \"# Unique Peptides\",\r\n      \"Is Unique Group?\",\r\n      \"Unique Peptides List\",\r\n      ...samplesForComparison.map(sample => `Average Abundance (${sample.name})`)\r\n    ];\r\n\r\n    const tableRows = Array.from(uniqueProteinAccessions).map(accession => {\r\n      const details = proteinDetailsMap.get(accession);\r\n      const rowData = [\r\n        accession,\r\n        details.description,\r\n        details.diseaseAssociation,\r\n        details.totalPeptides,\r\n        details.uniquePeptidesCount,\r\n        details.isUniqueGroup ? 'Yes' : 'No',\r\n        details.peptidesList\r\n      ];\r\n      // Add specific abundance for each sample\r\n      samplesForComparison.forEach(sample => {\r\n        const result = sample.analysisResults.find(res => res['Protein Accession'] === accession);\r\n        rowData.push(result ? result['Average Abundance'].toFixed(2) : 'N/A');\r\n      });\r\n      return rowData;\r\n    });\r\n\r\n    // Data for heatmap and bar chart\r\n    const visualizationData = Array.from(uniqueProteinAccessions).map(accession => {\r\n        const abundancesBySample = {};\r\n        samplesForComparison.forEach(sample => {\r\n            const result = sample.analysisResults.find(res => res['Protein Accession'] === accession);\r\n            abundancesBySample[sample.name] = result ? parseFloat(result['Average Abundance'].toFixed(2)) : 0;\r\n        });\r\n        return {\r\n            proteinAccession: accession,\r\n            abundancesBySample: abundancesBySample\r\n        };\r\n    });\r\n\r\n    return { headers, tableRows, visualizationData, uniqueProteinAccessions: Array.from(uniqueProteinAccessions), maxAbundance };\r\n  };\r\n\r\n  const { headers: comparativeHeaders, tableRows: comparativeTableRows, visualizationData, uniqueProteinAccessions: allUniqueProteins, maxAbundance } = getComparativeTableAndVisualizationData();\r\n\r\n\r\n  // useEffect to dynamically load Chart.js and verify its availability\r\n  useEffect(() => {\r\n    if (window.Chart) {\r\n      setIsChartLibraryLoaded(true);\r\n      return;\r\n    }\r\n\r\n    const chartjsUrl = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js';\r\n    const script = document.createElement('script');\r\n    script.src = chartjsUrl;\r\n    script.id = 'chartjs-script';\r\n    script.async = true;\r\n    script.onload = () => {\r\n      setIsChartLibraryLoaded(true);\r\n    };\r\n    script.onerror = () => {\r\n      setError(\"Error loading Chart.js library. The chart will not be available.\");\r\n    };\r\n    document.body.appendChild(script);\r\n\r\n    return () => {\r\n      const chartScript = document.getElementById('chartjs-script');\r\n      if (chartScript && chartScript.parentNode) chartScript.parentNode.removeChild(chartScript);\r\n    };\r\n  }, []); \r\n\r\n  // useEffect to render/update the comparative bar chart\r\n  useEffect(() => {\r\n    if (comparativeChartCanvasRef.current && selectedProteinForChart && isChartLibraryLoaded && samplesForComparison.length > 0) {\r\n      const proteinData = samplesForComparison.map(sample => {\r\n        const result = sample.analysisResults.find(res => res['Protein Accession'] === selectedProteinForChart);\r\n        return result ? parseFloat(result['Average Abundance'].toFixed(2)) : 0;\r\n      });\r\n\r\n      const labels = samplesForComparison.map(sample => sample.name);\r\n\r\n      if (comparativeChartInstance.current) {\r\n        comparativeChartInstance.current.destroy();\r\n      }\r\n\r\n      const ctx = comparativeChartCanvasRef.current.getContext('2d');\r\n      comparativeChartInstance.current = new window.Chart(ctx, {\r\n        type: 'bar',\r\n        data: {\r\n          labels: labels,\r\n          datasets: [{\r\n            label: `Average Abundance for ${selectedProteinForChart}`,\r\n            data: proteinData,\r\n            backgroundColor: 'rgba(59, 130, 246, 0.7)',\r\n            borderColor: 'rgba(59, 130, 246, 1)',\r\n            borderWidth: 1,\r\n          }]\r\n        },\r\n        options: {\r\n          responsive: true,\r\n          maintainAspectRatio: false,\r\n          plugins: {\r\n            legend: {\r\n              display: true,\r\n              position: 'top',\r\n            },\r\n            title: {\r\n              display: true,\r\n              text: `Comparative Abundance for ${selectedProteinForChart}`,\r\n            }\r\n          },\r\n          scales: {\r\n            x: {\r\n              title: {\r\n                display: true,\r\n                text: 'Sample',\r\n              }\r\n            },\r\n            y: {\r\n              beginAtZero: true,\r\n              title: {\r\n                display: true,\r\n                text: 'Average Abundance (Normalized)',\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      if (comparativeChartInstance.current) {\r\n        comparativeChartInstance.current.destroy();\r\n        comparativeChartInstance.current = null;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (comparativeChartInstance.current) {\r\n        comparativeChartInstance.current.destroy();\r\n        comparativeChartInstance.current = null;\r\n      }\r\n    };\r\n  }, [selectedProteinForChart, samplesForComparison, isChartLibraryLoaded]);\r\n\r\n\r\n  // Function to add a new sample input slot\r\n  const addSampleInputSlot = () => {\r\n    // Reverting to expect 'peptides' and 'proteins' files for each new slot\r\n    setSampleInputs([...sampleInputs, { id: nextSampleInputId, name: '', files: { peptides: null, proteins: null } }]);\r\n    setNextSampleInputId(nextSampleInputId + 1);\r\n  };\r\n\r\n  // Function to remove a sample input slot\r\n  const removeSampleInputSlot = (id) => {\r\n    setSampleInputs(sampleInputs.filter(slot => slot.id !== id));\r\n    setSelectedProcessedSampleIds(prev => prev.filter(sampleId => sampleId !== id));\r\n  };\r\n\r\n  // Handler for changing the name for a specific slot\r\n  const handleSampleNameChange = (id, newName) => {\r\n    setSampleInputs(sampleInputs.map(slot => slot.id === id ? { ...slot, name: newName } : slot));\r\n  };\r\n\r\n  // Handler for changing files for a specific slot\r\n  const handleSampleFileChange = (id, fileType, file) => {\r\n    setSampleInputs(sampleInputs.map(slot =>\r\n      slot.id === id ? { ...slot, files: { ...slot.files, [fileType]: file } } : slot // Fixed: Preserve slot properties including 'name'\r\n    ));\r\n  };\r\n\r\n  // Function to read and parse a CSV file manually\r\n  const parseCSV = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const text = e.target.result;\r\n        const rows = text.split('\\n').filter(row => row.trim() !== '');\r\n        if (rows.length === 0) {\r\n          resolve([]);\r\n          return;\r\n        }\r\n        const headers = rows[0].split(',').map(header => header.trim().replace(/\"/g, ''));\r\n        const data = [];\r\n        for (let i = 1; i < rows.length; i++) {\r\n          const values = rows[i].split(',');\r\n          if (values.length !== headers.length) {\r\n            console.warn(`Skipping row ${i + 1} due to column mismatch.`);\r\n            continue; \r\n          }\r\n          const rowObject = {};\r\n          headers.forEach((header, index) => {\r\n            rowObject[header] = values[index].trim().replace(/\"/g, '');\r\n          });\r\n          data.push(rowObject);\r\n        }\r\n        resolve(data);\r\n      };\r\n      reader.onerror = (e) => reject(e);\r\n      reader.readAsText(file);\r\n    });\r\n  };\r\n\r\n  // Function to process all configured samples - Reverting to original multi-file processing logic\r\n  const processAllSamples = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    const newProcessedSamples = [];\r\n    let hasError = false;\r\n\r\n    for (const sampleInput of sampleInputs) {\r\n      if (!sampleInput.name.trim()) {\r\n        setError(`Error: Sample in slot ${sampleInput.id} does not have a valid name.`);\r\n        hasError = true;\r\n        break;\r\n      }\r\n      // Now checking for both peptides and proteins files\r\n      if (!sampleInput.files.peptides || !sampleInput.files.proteins) {\r\n        setError(`Error: Sample \"${sampleInput.name}\" does not have both 'Peptides File' and 'Proteins File' loaded.`);\r\n        hasError = true;\r\n        break;\r\n      }\r\n      if (newProcessedSamples.some(s => s.name === sampleInput.name.trim())) {\r\n        setError(`Error: A sample with the name \"${sampleInput.name}\" already exists. Sample names must be unique.`);\r\n        hasError = true;\r\n        break;\r\n      }\r\n\r\n      try {\r\n        const peptidesData = await parseCSV(sampleInput.files.peptides);\r\n        const proteinsData = await parseCSV(sampleInput.files.proteins);\r\n\r\n        // --- Original processing logic (Steps 1-6) ---\r\n\r\n        // Step 1: Combine data\r\n        const peptidesMap = new Map();\r\n        peptidesData.forEach(p => {\r\n          if (!peptidesMap.has(p['Protein Accession'])) peptidesMap.set(p['Protein Accession'], []);\r\n          peptidesMap.get(p['Protein Accession']).push(p);\r\n        });\r\n\r\n        const proteinsMap = new Map();\r\n        proteinsData.forEach(p => proteinsMap.set(p['Accession'], p));\r\n\r\n        const mergedData = peptidesData.map(peptide => {\r\n          const proteinInfo = proteinsMap.get(peptide['Protein Accession']);\r\n          return {\r\n            ...peptide,\r\n            Description: proteinInfo ? proteinInfo.Description : '',\r\n            Accession: proteinInfo ? proteinInfo.Accession : '',\r\n            'Area IBIS_DDA_1': parseFloat(peptide['Area IBIS_DDA_1']) || 0,\r\n            '-10lgP': parseFloat(peptide['-10lgP']) || 0,\r\n          };\r\n        });\r\n\r\n        // Step 2: Data Normalization\r\n        const totalArea = mergedData.reduce((sum, item) => sum + item['Area IBIS_DDA_1'], 0);\r\n        const normFactor = totalArea > 0 ? 1000000 / totalArea : 1;\r\n        \r\n        const normalizedData = mergedData.map(item => ({\r\n          ...item,\r\n          'Area IBIS_DDA_1': item['Area IBIS_DDA_1'] * normFactor,\r\n        }));\r\n\r\n        // Step 3: Determine group uniqueness and unique peptides\r\n        const proteinGroups = new Map();\r\n        normalizedData.forEach(d => {\r\n          const group = d['Protein Group'];\r\n          if (!proteinGroups.has(group)) proteinGroups.set(group, new Set());\r\n          proteinGroups.get(group).add(d['Protein Accession']);\r\n        });\r\n\r\n        const uniquePeptides = new Map();\r\n        normalizedData.forEach(d => {\r\n          if (d['Unique'] === 'Y') {\r\n            if (!uniquePeptides.has(d['Protein Accession'])) uniquePeptides.set(d['Protein Accession'], new Set());\r\n            uniquePeptides.get(d['Protein Accession']).add(d.Peptide);\r\n          }\r\n        });\r\n        \r\n        const processedData = normalizedData.map(d => ({\r\n          ...d,\r\n          'Is Protein Group Unique?': proteinGroups.get(d['Protein Group']).size === 1,\r\n          'Unique Peptides List': Array.from(uniquePeptides.get(d['Protein Accession']) || []).join('; '),\r\n          '# Unique Peptides': (uniquePeptides.get(d['Protein Accession']) || []).size,\r\n        }));\r\n\r\n        // Step 4: Select the most reliable protein per group\r\n        const uniqueProteinsMap = new Map();\r\n        processedData.forEach(item => {\r\n          const group = item['Protein Group'];\r\n          if (!uniqueProteinsMap.has(group) || item['-10lgP'] > uniqueProteinsMap.get(group)['-10lgP']) {\r\n            uniqueProteinsMap.set(group, item);\r\n          }\r\n        });\r\n        const uniqueProteins = Array.from(uniqueProteinsMap.values());\r\n        \r\n        // Step 5: Filter by pathogenic variants\r\n        const pathogenicVariants = uniqueProteins.filter(p => \r\n          (p['Protein Accession'] && pathogenicPattern.test(p['Protein Accession'])) &&\r\n          (p.Description && p.Description.includes('PATHOGENIC_VARIANT'))\r\n        );\r\n\r\n        // Step 6: Calculate average abundance and prepare results\r\n        const finalResults = pathogenicVariants.map(variant => {\r\n          const peptidesForVariant = processedData.filter(p => p['Protein Accession'] === variant['Protein Accession']);\r\n          const totalPeptides = peptidesForVariant.length;\r\n          const avgArea = totalPeptides > 0 ? peptidesForVariant.reduce((sum, p) => sum + p['Area IBIS_DDA_1'], 0) / totalPeptides : 0;\r\n          const proteinsInGroup = proteinGroups.get(variant['Protein Group']).size;\r\n\r\n          return {\r\n            'Protein Accession': variant['Protein Accession'],\r\n            'Description': variant.Description,\r\n            'Average Abundance': avgArea,\r\n            '# Total Peptides': totalPeptides,\r\n            '# Unique Peptides': variant['# Unique Peptides'],\r\n            '# Proteins in Group': proteinsInGroup,\r\n            'Is Unique Group?': variant['Is Protein Group Unique?'],\r\n            'Unique Peptides List': variant['Unique Peptides List'],\r\n          };\r\n        }).sort((a, b) => b['Average Abundance'] - a['Average Abundance']);\r\n\r\n\r\n        newProcessedSamples.push({\r\n          id: sampleInput.id,\r\n          name: sampleInput.name.trim(),\r\n          analysisResults: finalResults,\r\n          totalPeptidesCount: peptidesData.length,\r\n          totalProteinsCount: uniqueProteins.length,\r\n          normalizationFactor: normFactor,\r\n        });\r\n\r\n      } catch (err) {\r\n        console.error(`Error processing sample ${sampleInput.name}:`, err);\r\n        setError(`An error occurred while processing sample \"${sampleInput.name}\". Please ensure both 'Peptides File' and 'Proteins File' are valid CSVs and contain expected columns. Specific error: ${err.message}`);\r\n        hasError = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!hasError) {\r\n      setProcessedSamples(newProcessedSamples);\r\n      // Select all processed samples by default for initial comparison\r\n      setSelectedProcessedSampleIds(newProcessedSamples.map(s => s.id));\r\n      if (newProcessedSamples.length > 0) {\r\n        setError(null); // Clear any previous error if processing was successful\r\n      } else {\r\n        setError(\"No samples could be processed. Ensure all files are loaded and names are correct.\");\r\n      }\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  // Handler for selecting/deselecting samples for comparison\r\n  const handleSelectSampleForComparison = (id) => {\r\n    setSelectedProcessedSampleIds(prevSelected =>\r\n      prevSelected.includes(id)\r\n        ? prevSelected.filter(sampleId => sampleId !== id)\r\n        : [...prevSelected, id]\r\n    );\r\n  };\r\n\r\n\r\n  // Function to get color for heatmap cell based on abundance\r\n  const getHeatmapColor = (abundance) => {\r\n    if (abundance === 0) return 'rgba(240, 240, 240, 1)'; // Light gray for N/A or zero\r\n    const hue = 210; // Blue hue\r\n    const saturation = 80; // %\r\n    const maxLightness = 95; // Lightest blue for lowest abundance (non-zero)\r\n    const minLightness = 30; // Darkest blue for highest abundance\r\n\r\n    const scaledAbundance = maxAbundance > 0 ? (abundance / maxAbundance) : 0;\r\n    const lightness = maxLightness - (scaledAbundance * (maxLightness - minLightness));\r\n    \r\n    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;\r\n  };\r\n\r\n\r\n  // Function to export the comparative table to CSV\r\n  const exportComparativeToCsv = () => {\r\n    if (comparativeTableRows.length === 0) {\r\n      setError(\"No comparative table data to export.\");\r\n      return;\r\n    }\r\n    setIsExporting(true);\r\n\r\n    const csvRows = [];\r\n    csvRows.push(comparativeHeaders.join(',')); // Add headers\r\n\r\n    comparativeTableRows.forEach(row => {\r\n      const formattedRow = row.map(cell => {\r\n        // Ensure cells with commas or quotes are properly escaped\r\n        if (typeof cell === 'string' && (cell.includes(',') || cell.includes('\"'))) {\r\n          return `\"${cell.replace(/\"/g, '\"\"')}\"`;\r\n        }\r\n        return cell;\r\n      });\r\n      csvRows.push(formattedRow.join(','));\r\n    });\r\n\r\n    const csvString = csvRows.join('\\n');\r\n    const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    if (link.download !== undefined) {\r\n      const url = URL.createObjectURL(blob);\r\n      link.setAttribute('href', url);\r\n      link.setAttribute('download', 'comparative_biomarker_analysis.csv');\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      URL.revokeObjectURL(url);\r\n    } else {\r\n      setError(\"Your browser does not support direct file download.\");\r\n    }\r\n    setIsExporting(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-100 min-h-screen p-4 sm:p-8 font-sans\">\r\n      <div className=\"max-w-4xl mx-auto bg-white p-6 rounded-3xl shadow-lg\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-extrabold text-blue-700 mb-2\">Multi-Sample Biomarker Analysis</h1>\r\n        <p className=\"text-lg text-gray-600 mb-8\">Load and compare the abundance of pathogenic proteins across different samples.</p>\r\n\r\n        {/* Section to manage sample slots */}\r\n        <div className=\"mb-8 p-6 bg-blue-50 rounded-3xl shadow-inner\">\r\n          <h2 className=\"text-xl font-bold text-blue-800 mb-4\">Manage Samples</h2>\r\n          {sampleInputs.map((sampleSlot, index) => (\r\n            <div key={sampleSlot.id} className=\"mb-6 p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\">\r\n              <div className=\"flex justify-between items-center mb-3\">\r\n                <label htmlFor={`sampleName-${sampleSlot.id}`} className=\"block text-base font-medium text-gray-700\">Sample {index + 1}</label>\r\n                {sampleInputs.length > 1 && (\r\n                  <button\r\n                    onClick={() => removeSampleInputSlot(sampleSlot.id)}\r\n                    className=\"text-red-600 hover:text-red-800 text-sm font-semibold\"\r\n                  >\r\n                    Remove\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                id={`sampleName-${sampleSlot.id}`}\r\n                value={sampleSlot.name}\r\n                onChange={(e) => handleSampleNameChange(sampleSlot.id, e.target.value)}\r\n                placeholder=\"Sample Name (e.g., Control, Treated)\"\r\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 mb-4\"\r\n              />\r\n              <div className=\"space-y-3\">\r\n                <div className=\"p-2 bg-gray-50 rounded-xl border border-gray-100\">\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Peptides File (`protein-peptides.csv`)</label>\r\n                  <input \r\n                    type=\"file\" \r\n                    accept=\".csv\"\r\n                    onChange={(e) => handleSampleFileChange(sampleSlot.id, 'peptides', e.target.files[0])} \r\n                    className=\"w-full text-gray-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-100 file:text-blue-700 hover:file:bg-blue-200\"\r\n                  />\r\n                </div>\r\n                <div className=\"p-2 bg-gray-50 rounded-xl border border-gray-100\">\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Proteins File (`proteins.csv`)</label>\r\n                  <input \r\n                    type=\"file\" \r\n                    accept=\".csv\"\r\n                    onChange={(e) => handleSampleFileChange(sampleSlot.id, 'proteins', e.target.files[0])} \r\n                    className=\"w-full text-gray-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-100 file:text-blue-700 hover:file:bg-blue-200\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          <button\r\n            onClick={addSampleInputSlot}\r\n            className=\"w-full py-2 px-4 bg-gray-200 text-gray-700 font-semibold rounded-2xl hover:bg-gray-300 transition-colors mb-4\"\r\n          >\r\n            + Add Sample Slot\r\n          </button>\r\n          <button\r\n            onClick={processAllSamples}\r\n            disabled={loading || sampleInputs.some(s => !s.name.trim() || !s.files.peptides || !s.files.proteins)}\r\n            className=\"w-full py-3 px-6 bg-blue-600 text-white font-bold rounded-2xl shadow-md hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n          >\r\n            {loading && (\r\n              <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n              </svg>\r\n            )}\r\n            <span>{loading ? \"Processing Samples...\" : \"Process All Samples\"}</span>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mt-4 p-4 text-red-700 bg-red-100 rounded-2xl border border-red-200\">\r\n            <p className=\"font-semibold\">Error:</p>\r\n            <p>{error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Sample Selector for Comparison */}\r\n        {processedSamples.length > 0 && (\r\n          <div className=\"mb-8 p-6 bg-gray-50 rounded-3xl shadow-inner\">\r\n            <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Select Samples for Comparison</h2>\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n              {processedSamples.map(sample => (\r\n                <label key={sample.id} className=\"inline-flex items-center p-2 bg-white rounded-xl border border-gray-200 shadow-sm cursor-pointer hover:bg-gray-100 transition-colors\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedProcessedSampleIds.includes(sample.id)}\r\n                    onChange={() => handleSelectSampleForComparison(sample.id)}\r\n                    className=\"form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"ml-2 text-gray-700 font-medium\">{sample.name}</span>\r\n                </label>\r\n              ))}\r\n            </div>\r\n            {selectedProcessedSampleIds.length > 0 && (\r\n              <p className=\"text-sm text-gray-600 mt-4\">Selected samples: {selectedProcessedSampleIds.length}</p>\r\n            )}\r\n          </div>\r\n        )}\r\n        \r\n        {/* Visualizations Section */}\r\n        {(visualizationData.length > 0 && isChartLibraryLoaded) && (\r\n          <div className=\"mt-8 p-6 bg-gray-50 rounded-3xl shadow-inner\">\r\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">Visualizations</h2>\r\n\r\n            {/* Comparative Bar Chart */}\r\n            <h3 className=\"text-xl font-bold text-gray-700 mb-4\">Comparative Bar Chart (Select a Protein)</h3>\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"proteinForChart\" className=\"block text-sm font-medium text-gray-700 mb-1\">Select Protein Accession:</label>\r\n              <select\r\n                id=\"proteinForChart\"\r\n                value={selectedProteinForChart}\r\n                onChange={(e) => setSelectedProteinForChart(e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\r\n                disabled={!allUniqueProteins || allUniqueProteins.length === 0}\r\n              >\r\n                <option value=\"\">-- Select a Protein --</option>\r\n                {allUniqueProteins.map(accession => (\r\n                  <option key={accession} value={accession}>{accession}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            {selectedProteinForChart && (\r\n              <div className=\"mb-8 p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\" style={{ height: '400px', width: '100%' }}>\r\n                <canvas ref={comparativeChartCanvasRef}></canvas>\r\n              </div>\r\n            )}\r\n            {!selectedProteinForChart && (\r\n                <div className=\"mb-8 p-4 text-gray-600 bg-gray-100 rounded-2xl border border-gray-200\">\r\n                    <p className=\"font-semibold\">Select a protein from the dropdown above to view its comparative abundance across samples.</p>\r\n                </div>\r\n            )}\r\n\r\n\r\n            {/* Heatmap */}\r\n            <h3 className=\"text-xl font-bold text-gray-700 mb-4 mt-8\">Comparative Abundance Heatmap</h3>\r\n            <div className=\"overflow-x-auto p-4 bg-white rounded-2xl border border-gray-200 shadow-sm\">\r\n                {visualizationData.length > 0 && samplesForComparison.length > 0 ? (\r\n                    <div className=\"inline-block min-w-full\">\r\n                        {/* Heatmap Header (Sample Names) */}\r\n                        <div className=\"flex flex-row sticky top-0 bg-white z-10 border-b border-gray-200\">\r\n                            <div className=\"flex-shrink-0\" style={{ width: '200px', padding: '8px', fontWeight: 'bold' }}>Protein Accession</div>\r\n                            {samplesForComparison.map(sample => (\r\n                                <div key={sample.id} className=\"flex-shrink-0 text-center\" style={{ width: '100px', padding: '8px', fontWeight: 'bold' }}>{sample.name}</div>\r\n                            ))}\r\n                        </div>\r\n                        {/* Heatmap Grid */}\r\n                        {visualizationData.map((proteinRow, rowIndex) => (\r\n                            <div key={rowIndex} className=\"flex flex-row border-b border-gray-100 hover:bg-gray-50\">\r\n                                <div className=\"flex-shrink-0 overflow-hidden whitespace-nowrap overflow-ellipsis\" style={{ width: '200px', padding: '8px', borderRight: '1px solid #e5e7eb' }} title={proteinRow.proteinAccession}>\r\n                                    {proteinRow.proteinAccession}\r\n                                </div>\r\n                                {samplesForComparison.map(sample => (\r\n                                    <div \r\n                                        key={sample.id} \r\n                                        className=\"flex-shrink-0 text-center flex items-center justify-center text-xs font-mono\" \r\n                                        style={{ \r\n                                            width: '100px', \r\n                                            padding: '8px', \r\n                                            backgroundColor: getHeatmapColor(proteinRow.abundancesBySample[sample.name]),\r\n                                            color: proteinRow.abundancesBySample[sample.name] > maxAbundance / 2 ? 'white' : 'black', // Text color for contrast\r\n                                            borderRight: '1px solid #e5e7eb'\r\n                                        }}\r\n                                        title={`Abundance: ${proteinRow.abundancesBySample[sample.name].toFixed(2)}`}\r\n                                    >\r\n                                        {proteinRow.abundancesBySample[sample.name] > 0 ? proteinRow.abundancesBySample[sample.name].toFixed(0) : 'N/A'}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"p-4 text-gray-600 bg-gray-100 rounded-2xl border border-gray-200\">\r\n                        <p className=\"font-semibold\">No data available for heatmap. Process samples and select them for comparison.</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {!visualizationData.length > 0 && processedSamples.length > 0 && (\r\n             <div className=\"mt-8 p-4 text-gray-700 bg-gray-100 rounded-2xl border border-gray-200\">\r\n                <p className=\"font-semibold\">Please select samples for comparison to generate visualizations.</p>\r\n            </div>\r\n        )}\r\n        {(processedSamples.length > 0 && !isChartLibraryLoaded) && (\r\n            <div className=\"mt-8 p-4 text-gray-700 bg-gray-100 rounded-2xl border border-gray-200\">\r\n                <p className=\"font-semibold\">Loading chart library... Please wait for visualizations to appear.</p>\r\n            </div>\r\n        )}\r\n\r\n        {/* Comparative Table Section */}\r\n        {comparativeTableRows.length > 0 && (\r\n          <div className=\"mt-8\">\r\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Comparative Abundance Table</h2>\r\n            <p className=\"text-gray-600 mb-4 text-sm italic\">\r\n                Normalized abundances for the selected samples.\r\n            </p>\r\n            <div className=\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4\">\r\n              <button\r\n                onClick={exportComparativeToCsv}\r\n                disabled={isExporting || comparativeTableRows.length === 0}\r\n                className=\"w-full py-3 px-6 bg-green-600 text-white font-bold rounded-2xl shadow-md hover:bg-green-700 transition-colors disabled:bg-green-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n              >\r\n                <span>{isExporting ? \"Exporting...\" : \"Export Comparative Table to Excel (CSV)\"}</span>\r\n              </button>\r\n            </div>\r\n            <div id=\"comparative-results-table\" className=\"overflow-x-auto rounded-xl shadow-inner border border-gray-200\">\r\n              <table className=\"min-w-full divide-y divide-gray-200\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    {comparativeHeaders.map((header, index) => (\r\n                      <th key={index} className=\"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">{header}</th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {comparativeTableRows.map((row, rowIndex) => (\r\n                    <tr key={rowIndex} className=\"hover:bg-gray-50 transition-colors\">\r\n                      {row.map((cell, cellIndex) => (\r\n                        <td key={cellIndex} className={`px-4 sm:px-6 py-4 whitespace-normal text-sm ${cellIndex < 2 ? 'font-medium text-gray-900' : 'text-gray-700 font-mono'}`}>{cell}</td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}